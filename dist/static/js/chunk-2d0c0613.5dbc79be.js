(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d0c0613"],{4210:function(t,e,a){"use strict";a.r(e);var r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("el-card",[a("CategorySelector",{attrs:{disabled:t.isShowList},on:{handlerCategory:t.handlerCategory}})],1),a("el-card",{staticStyle:{"margin-top":"20px"}},[a("div",{directives:[{name:"show",rawName:"v-show",value:t.isShowList,expression:"isShowList"}]},[a("el-button",{attrs:{icon:"el-icon-plus",type:"primary",disabled:!t.category3Id},on:{click:function(e){t.isShowList=!1}}},[t._v("添加属性")]),a("el-table",{staticStyle:{width:"100%","margin-top":"20px"},attrs:{data:t.attrList,border:""}},[a("el-table-column",{attrs:{type:"index",label:"序号",align:"center",width:"80"}}),a("el-table-column",{attrs:{label:"属性名称",prop:"attrName",align:"center",width:"100"}}),a("el-table-column",{attrs:{label:"属性值列表",prop:"attrList",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){var r=e.row;return t._l(r.attrValueList,(function(e){return a("el-tag",{key:e.id,staticStyle:{margin:"2px"}},[t._v(t._s(e.name))])}))}}])}),a("el-table-column",{attrs:{label:"操作",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){var r=e.row;return[a("HintButton",{attrs:{size:"mini",type:"warning",icon:"el-icon-edit",title:"修改"},on:{click:function(e){return t.showUpdateDiv(r)}}}),a("HintButton",{attrs:{size:"mini",type:"danger",icon:"el-icon-delete",title:"删除"},on:{click:function(e){return t.deleteAttr(r.attrId)}}})]}}])})],1)],1),a("div",{directives:[{name:"show",rawName:"v-show",value:!t.isShowList,expression:"!isShowList"}]},[a("el-form",{attrs:{inline:!0,model:t.attrForm}},[a("el-form-item",{attrs:{label:"属性名"}},[a("el-input",{ref:"attrInput",attrs:{placeholder:"请输入属性名"},model:{value:t.attrForm.attrName,callback:function(e){t.$set(t.attrForm,"attrName",e)},expression:"attrForm.attrName"}})],1)],1),a("el-button",{attrs:{type:"primary",disabled:!t.attrForm.attrName},on:{click:t.addAttrValue}},[t._v("添加属性值")]),a("el-button",{on:{click:t.backToShowAttrList}},[t._v("取消")]),a("el-table",{staticStyle:{margin:"20px 0"},attrs:{border:"",data:t.attrForm.attrValueList}},[a("el-table-column",{attrs:{type:"index",width:"80",label:"序号",align:"center"}}),a("el-table-column",{attrs:{label:"属性值"},scopedSlots:t._u([{key:"default",fn:function(e){var r=e.row,i=e.$index;return[r.isEdit?a("el-input",{ref:i,attrs:{placeholder:"请输入属性值",size:"mini"},on:{blur:function(e){return t.toLock(r)}},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.toLock(r)}},model:{value:r.name,callback:function(e){t.$set(r,"name",e)},expression:"row.name"}}):a("span",{staticStyle:{display:"block",width:"100%",height:"100%"},on:{click:function(e){return t.toEditMode(r,i)}}},[t._v(t._s(r.name))])]}}])}),a("el-table-column",{attrs:{width:"200",label:"操作",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){var r=e.row,i=e.$index;return[a("el-popconfirm",{attrs:{title:"确定要删除"+r.name+"属性值吗？"},on:{onConfirm:function(e){return t.attrForm.attrValueList.splice(i,1)}}},[a("HintButton",{attrs:{slot:"reference",type:"danger",size:"mini",icon:"el-icon-delete",title:"删除属性"},slot:"reference"})],1)]}}])})],1),a("el-button",{attrs:{type:"primary",disabled:0==t.attrForm.attrValueList.length},on:{click:t.save}},[t._v("保存")]),a("el-button",{on:{click:t.backToShowAttrList}},[t._v("取消")])],1)])],1)},i=[],n=(a("159b"),a("b0c0"),a("498a"),a("4de4"),a("0644")),o=a.n(n),s={name:"Attr",data:function(){return{category1Id:"",category2Id:"",category3Id:"",attrList:[],isShowList:!0,attrForm:{attrName:"",attrValueList:[],categoryId:0,categoryLevel:3}}},methods:{showInfo:function(t){this.$message.info("点击成功，返回值为:",t)},handlerCategory:function(t){var e=t.categoryId,a=t.level;1==a?(this.category1Id=e,this.category2Id="",this.category3Id="",this.attrList=[]):2==a?(this.category2Id=e,this.category3Id="",this.attrList=[]):(this.category3Id=e,this.attrList=this.$API.attr.getAttrList(this.category1Id,this.category2Id,this.category3Id))},backToShowAttrList:function(){this.attrForm={attrName:"",attrValueList:[],categoryId:this.category3Id,categoryLevel:3},this.isShowList=!0},addAttrValue:function(){var t=this;this.attrForm.attrValueList.push({attrId:this.attrForm.attrId,name:"",isEdit:!0}),this.$nextTick((function(){t.$refs[t.attrForm.attrValueList.length-1].focus()}))},showUpdateDiv:function(t){var e=this;this.attrForm=o()(t),this.attrForm.attrValueList.forEach((function(t){return e.$set(t,"isEdit",!1)})),this.isShowList=!1},toLock:function(t){if(t.name=t.name.trim(),""!=t.name){var e=this.attrForm.attrValueList.some((function(e){if(e!==t)return e.name==t.name}));if(e)return this.$message.info("输入的属性名称不能重复"),void(t.name="");t.isEdit=!1}},toEditMode:function(t,e){var a=this;t.isEdit=!0,this.$nextTick((function(){a.$refs[e].focus()}))},save:function(){var t=this,e=this.attrForm;if(!e.attrName)return this.$message.warning("请输入属性名！"),void this.$refs["attrInput"].focus();e.attrValueList=e.attrValueList.filter((function(e){if(""!=e.name.trim())return delete e.isEdit,t.attrForm={attrName:"",attrValueList:[],categoryId:t.category3Id,categoryLevel:3},!0})),this.$API.attr.addOrUpdateAttr(e),this.$message.success("添加属性成功"),this.isShowList=!0,this.attrList=this.$API.attr.getAttrList(this.category1Id,this.category2Id,this.category3Id)},deleteAttr:function(t){this.$API.attr.deleteAttr(t),this.attrList=this.$API.attr.getAttrList(this.category1Id,this.category2Id,this.category3Id)}}},l=s,c=a("2877"),d=Object(c["a"])(l,r,i,!1,null,null,null);e["default"]=d.exports}}]);